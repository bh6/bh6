<!DOCTYPE html>
<html>
<head>
    <meta charset="ISO-8859-1">
    <title>Where your are?</title>
    <!-- Include Google API  -->
    <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <!-- Include jQuery Mobile stylesheets -->
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <!-- Include the jQuery library -->
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- Include the jQuery Mobile library -->
    <script>
        $(document).bind('mobileinit', function () {
            $.mobile.changePage.defaults.changeHash = false;
            $.mobile.hashListeningEnabled = false;
            $.mobile.pushStateEnabled = false;
        });
    </script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>


    <link rel="stylesheet" type="text/css" href="./css/checkin.css"/>
    <link rel="stylesheet" type="text/css" href="./css/faces.css"/>
    <link rel="stylesheet" type="text/css" href="./css/facesdetail.css"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
    <script type="text/javascript">
        function update_user(updatedUser) {

            console.log(updatedUser)
            // clear the existing list
            $('#users .list li').remove();

            $.each(updatedUser, function (index, userName) {
                var htmlstr = "";
                htmlstr += "<li id=\"userlist-";
                htmlstr +=index;
                htmlstr +="\" onclick=\"toggleUserDetail(this)\" class=\"search-card\" data-cards-index=\"1\"\n";
                htmlstr += "style=\"list-style-type:none;\">\n";
                htmlstr += "<div class=\"up-card standard card-header card-clickable ui-grid-a\">\n";
                htmlstr += "<div class=\"ui-block-a\" style=\"width: 16.66666667%\">\n";
                htmlstr += "<div class=\"grid-header\"\n";
                htmlstr += "<div class=\"profile-image\" style=\"vertical-align:middle;\">\n";
                htmlstr += "<div class=\"profile-image-wrap user-photo-inner\" style=\"width: 50px; height: 50px;\">\n";
                htmlstr += "<img\n";
                htmlstr += "src=\"./" + userName.imgurl + "\"\n";
                htmlstr += "class=\"user-photo\" alt=\"\" width=\"30\" height=\"30\"\n";
                htmlstr += "data-src=\"" + userName.imgurl + "\"\n";
                htmlstr += "</div>\n";
                htmlstr += "</div>\n";
                htmlstr += "</div>\n";
                htmlstr += "</div>\n";
                htmlstr += "<div class=\"ui-block-b\" style=\"width: 83.33333333%\">\n";
                htmlstr += "<div class=\"profile-contact-details\">\n";
                htmlstr += "<div class=\"profile-name\">" + userName.name + "</div>\n";
                htmlstr += "<ul>\n";
                htmlstr += "<li class=\"email\"><a href=\"mailto:";
                htmlstr += userName.contact.email;
                htmlstr += "\" tabindex=\"3\">";
                htmlstr += userName.contact.email;
                htmlstr += "</a> </li>\n";;
                htmlstr += "</li>\n";
                htmlstr += "<li class=\"phone\">" + userName.contact.mobile + "</li>\n";
                htmlstr += "</ul></div> </div> </div>";
                htmlstr += "<div id=\"detailinfo\" class=\"facesdetaildisplaynone card-tr\"><div class=\"card-td col3\"></div><div class=\"card-td col4\"><div class=\"contact-block\"><div class=\"dept\">IBM Systems, Middleware</div><div class=\"city\">Zürich, CH</div><div class=\"phone\">+41 58 333 57 41 (Office)</div> <div class=\"phone\">+41 79 109 32 17 (Mobile)</div><div class=\"email\"><a href=\"mailto:raphael.ochsenbein@ch.ibm.com\" tabindex=\"3\">raphael.ochsenbein@ch.ibm.com</a> </div><div class=\"notes-id\">Raphael Ochsenbein/Switzerland/IBM</div></div></div></div>"

                htmlstr += "</li>\n";

                $('#users .list').append(htmlstr);

            });
        }
    </script>
    <script type="text/javascript">
        function toggleUserDetail(elem){
            var toggled;
            console.log( $(elem.id).find("detailinfo") );
            $(elem.id).find("detailinfo").html();
            console.log( $( '#userlist-0 #detailinfo' ).attr('class') );
            $(elem.id).find("detailinfo").removeClass('facesdetaildisplaynone');
            console.log( $( '#userlist-0 #detailinfo').attr('class') );
        }
    </script>
    <script type="application/javascript">
        // Get the updated list
        function update() {
            var updated_users = [{
                "id": "1",
                "name": "Arend Berg",
                "title": "Senior IT Architect - Solution Architect",
                "contact": {
                    "mobile": "+49 171 3383894",
                    "email": "Arend.Berg@de.ibm.com"
                },
                "imgurl": "images/arend.jpg",
                "skills": {
                    "id": "1",
                    "name": "IT Architecture",
                    "level": 2
                },
                "lastcheckinglocation": {
                    "id": "1",
                    "name": "Hotel1",
                    "type": "HOTEL",
                    "gps": {"x": 33.0, "y": 45.0},
                    "adress": {"street": "Kurfurstendamm", "number": 100, "plz": 10709, "stadt": "Berlin"}
                }
            }, {
                "id": "2",
                "name": "Torsten Froemert",
                "title": "Senior Consultant",
                "contact": {
                    "mobile": "+49 170 4147 387",
                    "email": "tfroemert@de.ibm.com"
                },
                "imgurl": "images/torsten.jpg",
                "skills": {
                    "id": "1",
                    "name": "IBM Commerce",
                    "level": 2
                },
                "lastcheckinglocation": {
                    "id": "1",
                    "name": "Hotel1",
                    "type": "HOTEL",
                    "gps": {"x": 33.0, "y": 45.0},
                    "adress": {"street": "Kurfurstendamm", "number": 100, "plz": 10709, "stadt": "Berlin"}
                }
            }];
            // Update it
            update_user(updated_users);
        }
        //Example by AJAX get using a made-up URL
    </script>


</head>
<body onload="update();">

<div class="container">
    <section id="content">

        <form action="">
                <ul class="list" data-role="listview" data-inset="true" data-split-icon="star">
                    <li id="userlist-0" class="search-card" data-cards-index="1" style="list-style-type:none;">
                        <input type="text" name="text-basic" id="text-basic" value="" placeholder="Search for skills available from nearby IBMer's...">
                    </li>
                </ul>

            <div id="users">
                <ul class="list" data-role="listview" data-inset="true" data-split-icon="star">
                    <li>
                        <a href="#"><h3 class="name">Berlin</h3></a>
                    </li>
                </ul>
            </div>
        </form>
        <!-- form -->

    </section>
    <!-- content -->
</div>
<!-- container -->

</body>
</html>